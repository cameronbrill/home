name: Setup Python
description: Sets up Python and dependencies using mise and uv

runs:
  using: "composite"
  steps:
    - name: Install python and uv
      uses: jdx/mise-action@e3d7b8d67a7958d1207f6ed871e83b1ea780e7b0 # v3
      with:
        install: true
        cache: true
        install_args: "python uv"

    - name: Restore uv cache
      uses: actions/cache@0057852bfaa89a56745cba8c7296529d2fc39830 # v4
      with:
        path: /tmp/.uv-cache
        key: uv-${{ runner.os }}-${{ hashFiles('uv.lock') }}
        restore-keys: |
          uv-${{ runner.os }}-${{ hashFiles('uv.lock') }}
          uv-${{ runner.os }}-

    - name: Install dependencies
      env:
        # Configure a constant location for the uv cache
        UV_CACHE_DIR: /tmp/.uv-cache
      shell: bash
      run: |
        uv sync --group dev --locked
